{# templates/base.html #}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <title>Soap | Dashboard</title>
    
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
    <link rel="icon" href="{{ url_for('favicon') }}" type="image/x-icon">

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-QL7EMV1Y4X"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-QL7EMV1Y4X');
    </script>
    {% block head_extra %}{% endblock %}
</head>
<body>
    <!-- Navbar - matching your new index.html structure -->
<nav class="navbar">
    <a href="https://www.use.soap.fyi">Home</a>
    <div class="navbar-title">Soap Dashboard</div>
    <div class="navbar-right-menu">
        <a href="/">Dash</a>
    </div>
</nav>

    <!-- Main content area -->
    <div class="main-content-wrapper" style="padding: 1rem; flex-grow: 1;">
        <div class="contribute-link-container" style="text-align: center; margin-bottom: 1.5rem; padding-top: 5px;"> 
            <p>Contribute to the project here: <a href="https://use.soap.fyi" style="color: #76B0DF; font-weight: bold;">use.soap.fyi</a></p>
        </div>

        {% if not engine_available and active_tab is defined and active_tab is not none %}
            <section style="background-color: #ffdddd; color: #d8000c; padding: 1rem; border-radius: 8px; margin-bottom: 1.5rem;">
              ðŸ”´ CRITICAL: Database connection failed. Dashboard cannot operate.
            </section>
        {% else %}
            {% block content %}{% endblock %}
        {% endif %}
    </div>

    <!-- Footer -->
    <footer class="footer">
        <p>&copy; Copyright 2024-<span id="currentYear"></span> <a class="footer-link" href="https://soap.fyi">soap.fyi</a>. All rights reserved.</p>
    </footer>
    <script>
    // Get the current year
    const year = new Date().getFullYear();

    // Find the HTML element with the id "currentYear" and set its text content
    document.getElementById("currentYear").textContent = year;
    </script>
    
    {% block scripts %}
    <script>
        function updateSliderValue(sliderId, outputId) {
            const slider = document.getElementById(sliderId);
            const output = document.getElementById(outputId);
            if (slider && output) {
                output.innerHTML = slider.value;
            }
        }

        document.addEventListener('DOMContentLoaded', function() {
            // Initialize slider values on page load if the slider is present
            // This code will run on every page, but only act if the elements exist.
            
            // For sentiment Tab Slider (if it exists on the current page)
            const sentimentSlider = document.getElementById('min_votes_slider_sentiment');
            const sentimentOutput = document.getElementById('slider_value_sentiment');
            if (sentimentSlider && sentimentOutput) {
                sentimentOutput.innerHTML = sentimentSlider.value;
                // No need for active_tab check here if the element IDs are unique
                // and only appear on the sentiment tab's content.
            }

            // If you have other sliders on other tabs, add their initialization here:
            // Example:
            // const trendsSlider = document.getElementById('some_other_slider_id_for_trends');
            // const trendsOutput = document.getElementById('some_other_output_id_for_trends');
            // if (trendsSlider && trendsOutput) {
            //     trendsOutput.innerHTML = trendsSlider.value;
            // }
        });
    </script>
    {% endblock %}
</body>
</html>